# Phase 5 功能增强 - 全面测试计划

**测试日期**: 2026-01-15
**测试版本**: Phase 5 完整版
**测试人**: Claude (Sonnet 4.5)

---

## 测试策略

### 测试级别
1. **单元测试** - 后端编译、前端编译
2. **功能测试** - 每个子任务的核心功能
3. **集成测试** - 功能之间的交互
4. **边界测试** - 异常输入、边界条件
5. **性能测试** - 响应时间、内存占用
6. **用户体验测试** - UI/UX 流畅度

### 测试优先级
- **P0 (阻塞)**: 核心功能失败，阻止发布
- **P1 (严重)**: 重要功能异常，影响用户体验
- **P2 (一般)**: 次要问题，可延后修复
- **P3 (建议)**: 优化建议，非必要

---

## 测试清单

### ✅ 阶段 1: 编译测试

#### 1.1 后端编译
- [ ] Go 代码编译无错误
- [ ] Wails 绑定生成成功
- [ ] 无未使用的导入

#### 1.2 前端编译
- [ ] TypeScript 类型检查通过
- [ ] Vue 组件编译成功
- [ ] Vite 构建无错误
- [ ] 无 ESLint 警告

#### 1.3 完整构建
- [ ] `wails3 task build` 成功
- [ ] 生成的二进制文件可运行
- [ ] 应用启动无崩溃

---

### ✅ 阶段 2: 子任务功能测试

#### 2.1 Subtask 5.1: 统一 MCP 架构
- [ ] 创建 stdio 类型 MCP 服务器
- [ ] 创建 http 类型 MCP 服务器
- [ ] 创建 sse 类型 MCP 服务器
- [ ] 平台选择器正确显示三平台
- [ ] 配置同步到 Gemini CLI
- [ ] 配置同步到 Claude Code
- [ ] 配置同步到 Codex
- [ ] 删除 MCP 服务器成功

#### 2.2 Subtask 5.2: 技能生态集成
- [ ] Skill 列表正确显示
- [ ] 版本号正确显示
- [ ] 更新提示正确出现
- [ ] 一键更新功能正常
- [ ] 安装新 Skill 成功
- [ ] 卸载 Skill 成功

#### 2.3 Subtask 5.3: UI/UX 增强
**色彩自定义**:
- [ ] 打开 Provider 编辑弹窗
- [ ] 颜色选择器显示正常
- [ ] 选择 Tint 颜色后预览卡片更新
- [ ] 选择 Accent 颜色后预览卡片更新
- [ ] 保存后卡片应用新颜色
- [ ] 刷新页面颜色保持

**动态搜索**:
- [ ] 输入 Provider 名称进行搜索
- [ ] 搜索结果实时过滤
- [ ] 搜索 API URL 正确过滤
- [ ] 搜索官网正确过滤
- [ ] 清除搜索按钮恢复列表
- [ ] 空搜索结果显示提示

**全局快捷键**:
- [ ] 按 Cmd+, (macOS) 或 Ctrl+, (Windows) 打开设置
- [ ] 快捷键在主页有效
- [ ] 快捷键在日志页有效
- [ ] 快捷键在 MCP 页有效

#### 2.4 Subtask 5.4: 配置导入导出
**导出功能**:
- [ ] 打开设置页，找到"配置分享"区域
- [ ] 勾选"Provider 配置"
- [ ] 勾选"MCP 服务器配置"
- [ ] 取消勾选"过滤 API 密钥"
- [ ] 选择平台 (Claude, Codex, Gemini-CLI)
- [ ] 点击"生成分享链接"
- [ ] 分享链接正确生成
- [ ] 点击"复制"按钮
- [ ] 验证剪贴板内容
- [ ] 链接格式为 `codeswitch://import?config=...`

**导入功能**:
- [ ] 粘贴有效的 Deep Link
- [ ] 点击"导入"按钮
- [ ] Toast 提示导入成功
- [ ] 导入的 Provider 显示在列表
- [ ] 导入的 MCP 服务器显示在列表
- [ ] API 密钥未被覆盖（如果已过滤）
- [ ] 重复导入不覆盖现有配置

**边界条件**:
- [ ] 导入空配置提示"无内容"
- [ ] 导入无效 Base64 提示错误
- [ ] 导入错误的 URL scheme 提示错误
- [ ] 导入缺少 config 参数提示错误

#### 2.5 Subtask 5.5: 日志监控增强
**Request Body 查看器**:
- [ ] 发起一个 AI 请求（确保有日志）
- [ ] 打开日志页面
- [ ] 点击某条日志的"查看详情"
- [ ] Modal 弹出显示"基本信息"标签
- [ ] 切换到"Body"标签
- [ ] 加载指示器显示
- [ ] Request Body 正确显示
- [ ] Response Body 正确显示
- [ ] JSON 格式化正确
- [ ] Body 大小正确显示
- [ ] 过期时间正确显示
- [ ] 关闭 Modal

**成本趋势图**:
- [ ] 主页显示趋势图
- [ ] X 轴显示时间标签
- [ ] Y 轴显示成本数值
- [ ] 悬停显示详细信息
- [ ] 深色模式下图表主题切换
- [ ] 无数据时显示空状态

---

### ✅ 阶段 3: 集成测试

#### 3.1 配置流转测试
- [ ] 创建 Provider → 色彩自定义 → 搜索过滤 → 导出 → 删除 → 导入 → 验证恢复

#### 3.2 MCP 跨平台测试
- [ ] 创建 MCP 服务器 → 启用三平台 → 验证配置文件同步 → 启动 CLI 验证

#### 3.3 日志完整性测试
- [ ] 发起请求 → 查看日志列表 → 查看 Body → 验证数据一致性

---

### ✅ 阶段 4: 性能测试

#### 4.1 响应时间
- [ ] 主页加载时间 < 2s
- [ ] Provider 列表渲染时间 < 500ms
- [ ] 日志列表加载时间 < 1s
- [ ] Body 数据加载时间 < 500ms
- [ ] 搜索过滤响应时间 < 100ms

#### 4.2 内存占用
- [ ] 应用启动内存 < 200MB
- [ ] 运行 1 小时内存增长 < 50MB
- [ ] 无明显内存泄漏

---

### ✅ 阶段 5: 用户体验测试

#### 5.1 错误提示
- [ ] 网络错误有友好提示
- [ ] 表单验证错误清晰
- [ ] Toast 通知不遮挡内容
- [ ] 加载状态指示明确

#### 5.2 界面一致性
- [ ] 深色模式所有页面正常
- [ ] 浅色模式所有页面正常
- [ ] 中英文切换无乱码
- [ ] 布局无错位

---

## 测试执行记录

### 执行顺序
1. **阶段 1: 编译测试** (15 分钟)
2. **阶段 2: 子任务功能测试** (30 分钟)
3. **阶段 3: 集成测试** (15 分钟)
4. **阶段 4: 性能测试** (10 分钟)
5. **阶段 5: 用户体验测试** (10 分钟)

**预计总时间**: 80 分钟

---

## 测试环境

- **OS**: Windows Server 2019
- **Go 版本**: 1.24+
- **Node.js**: 18+
- **Wails**: 3.0.0-alpha.41
- **浏览器**: Chrome/Edge (最新版)

---

## 缺陷记录模板

```
### Bug #[ID]
- **优先级**: P0 / P1 / P2 / P3
- **子任务**: Subtask X.X
- **标题**: [简短描述]
- **复现步骤**:
  1. ...
  2. ...
- **预期结果**: ...
- **实际结果**: ...
- **截图/日志**: ...
- **状态**: 待修复 / 已修复 / 已验证
```

---

## 测试结果汇总

将在测试执行后填写：

- **测试用例总数**: TBD
- **通过**: TBD
- **失败**: TBD
- **阻塞问题**: TBD
- **建议改进**: TBD
- **发布建议**: ✅ 可发布 / ⚠️ 有风险 / ❌ 不可发布

---

**文档版本**: v1.0
**创建时间**: 2026-01-15
**状态**: 📋 测试计划已制定，等待执行
